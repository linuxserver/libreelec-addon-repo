#!/bin/sh

name="docker.linuxserver.mariadb"
. /etc/profile

oe_setup_addon "$name"

if [ "$E_kodi_mysql" = "true" ]; then
  #get arch variable from os
  LEARCHVAR=`sed -e '/LIBREELEC_ARCH/ !d' -e 's/[^.]*\.\([^"]*\).*/\1/' /etc/os-release`

  #figure out which docker hub image to use
  if [ "$LEARCHVAR" = "x86_64" ]; then
    DOCKERIMAGE="linuxserver/mariadb"
  elif [ "$LEARCHVAR" = "arm" ]; then
    DOCKERIMAGE="lsioarmhf/mariadb"
  elif [ "$LEARCHVAR" = "aarch64" ]; then
    DOCKERIMAGE="lsioarmhf/mariadb-aarch64"
  fi

  if ! docker images | grep -q "$DOCKERIMAGE"; then
    docker pull "$DOCKERIMAGE":latest
  fi
fi
